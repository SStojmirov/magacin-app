<!DOCTYPE html>
<html lang="mk">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>–ú–∞–≥–∞—Ü–∏–Ω</title>
  <style>
    body {
      margin: 0; font-family: Arial, sans-serif; height: 100vh;
      display: flex; justify-content: center; align-items: center;
      background: linear-gradient(135deg, #1f1f1f, #333);
    }
    #login-card {
      background: #fff; border-radius: 12px; padding: 40px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3); text-align: center;
      width: 300px;
    }
    #login-card input {
      width: 100%; padding: 10px; margin: 10px 0; border-radius: 6px; border: 1px solid #ccc;
    }
    #login-card button {
      width: 100%; padding: 10px; background: #007BFF; border: none; border-radius: 6px; color: #fff;
      font-size: 16px; cursor: pointer;
    }
    #login-card button:hover { background: #0056b3; }
    #app { display: none; }
    h2 { text-align: center; }
    #lista div { margin: 5px; padding: 5px; border: 1px solid #ddd; }
  </style>
  <script type="module">
    import { initializeApp } from "https://www.gstatic.com/firebasejs/11.0.1/firebase-app.js";
    import { getFirestore, collection, getDocs, addDoc, deleteDoc, doc } 
      from "https://www.gstatic.com/firebasejs/11.0.1/firebase-firestore.js";

    // üëá –í–Ω–µ—Å–∏ –≥–∏ —Ç–≤–æ–∏—Ç–µ Firebase –ø–æ–¥–∞—Ç–æ—Ü–∏ —Ç—É–∫–∞
    const firebaseConfig = {
  apiKey: "AIzaSyAbCqqSwKQ62Q38K-DM15jsZQePloDD8XM",
  authDomain: "magacinapp-6a8f5.firebaseapp.com",
  projectId: "magacinapp-6a8f5",
  storageBucket: "magacinapp-6a8f5.firebasestorage.app",
  messagingSenderId: "160054879907",
  appId: "1:160054879907:web:ded639dcd0a9e0a64e4116"
};

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);

    const password = "evi"; // —Ç–≤–æ—ò–∞—Ç–∞ –ª–æ–∑–∏–Ω–∫–∞
    const loginCard = document.getElementById("login-card");
    const appDiv = document.getElementById("app");

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–∞–ª–∏ –ª–æ–∑–∏–Ω–∫–∞—Ç–∞ –µ –∑–∞—á—É–≤–∞–Ω–∞
    if(localStorage.getItem("magacin_pass") === password){
      loginCard.style.display = "none";
      appDiv.style.display = "block";
    }

    function checkLogin(){
      const input = document.getElementById("pass").value;
      if(input === password){
        localStorage.setItem("magacin_pass", password);
        loginCard.style.display = "none";
        appDiv.style.display = "block";
        prikaziArtikli();
      } else {
        alert("–ù–µ—Ç–æ—á–Ω–∞ –ª–æ–∑–∏–Ω–∫–∞!");
      }
    }

    // üü¢ Firebase –º–∞–≥–∞—Ü–∏–Ω—Å–∫–∞ –ª–æ–≥–∏–∫–∞
    const listaDiv = document.getElementById("lista");
    const form = document.getElementById("form");

    async function prikaziArtikli() {
      listaDiv.innerHTML = "";
      const querySnapshot = await getDocs(collection(db, "artikli"));
      querySnapshot.forEach((docu) => {
        const data = docu.data();
        listaDiv.innerHTML += `
          <div>
            <b>${data.ime}</b> ‚Äì ${data.kolicina} ${data.merka} (${data.cena} $)
            <button onclick="izbrisi('${docu.id}')">–ò–∑–±—Ä–∏—à–∏</button>
          </div>`;
      });
    }

    async function dodadiArtikl(e) {
      e.preventDefault();
      const ime = form.ime.value;
      const kolicina = parseFloat(form.kolicina.value);
      const merka = form.merka.value;
      const cena = parseFloat(form.cena.value);
      await addDoc(collection(db, "artikli"), { ime, kolicina, merka, cena });
      form.reset();
      prikaziArtikli();
    }

    async function izbrisi(id) {
      await deleteDoc(doc(db, "artikli", id));
      prikaziArtikli();
    }

    form.addEventListener("submit", dodadiArtikl);
    window.izbrisi = izbrisi;
    window.checkLogin = checkLogin;
  </script>
</head>
<body>

  <!-- Login –µ–∫—Ä–∞–Ω -->
  <div id="login-card">
    <h2>üîí –í–Ω–µ—Å–∏ –ª–æ–∑–∏–Ω–∫–∞</h2>
    <input type="password" id="pass" placeholder="–õ–æ–∑–∏–Ω–∫–∞">
    <button onclick="checkLogin()">–í–ª–µ–∑–∏</button>
  </div>

  <!-- –ú–∞–≥–∞—Ü–∏–Ω –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞ -->
  <div id="app">
    <h2>üì¶ –ú–∞–≥–∞—Ü–∏–Ω—Å–∫–∞ –∞–ø–ª–∏–∫–∞—Ü–∏—ò–∞</h2>
    <form id="form">
      <input name="ime" placeholder="–ò–º–µ –Ω–∞ –∞—Ä—Ç–∏–∫–ª" required>
      <input name="kolicina" type="number" placeholder="–ö–æ–ª–∏—á–∏–Ω–∞" required>
      <input name="merka" placeholder="–ú–µ—Ä–∫–∞ (–ø–∞—Ä—á–µ, –∫–≥...)" required>
      <input name="cena" type="number" step="0.01" placeholder="–¶–µ–Ω–∞" required>
      <button type="submit">–î–æ–¥–∞—ò</button>
    </form>
    <div id="lista"></div>
  </div>

</body>
</html>
